{% extends 'base.html.twig' %}
{% block title %}Mes compétences{% endblock %}

{% block body %}
<h1>Mes compétences</h1>

{% for label, messages in app.flashes %}
  {% for message in messages %}
    <div class="flash-{{ label }}">{{ message }}</div>
  {% endfor %}
{% endfor %}

<p class="mb-3">
  <a class="btn btn-primary" href="{{ path('app_user_skills_new') }}">➕ Ajouter une compétence</a>
  <a class="btn btn-secondary" href="{{ path('app_home') }}">🏠 Accueil</a>
</p>

<table class="table">
  <thead>
    <tr>
      <th>Compétence</th>
      <th>Niveau</th>
      <th>Notes</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
  {% for us in mySkills %}
    <tr>
      <td>{{ us.skill.name }}</td>
      {# Enum PHP BackedEnum -> on affiche la "value" (beginner/intermediate/...) #}
      <td>{{ us.level.value }}</td>
      <td>{{ us.notes ?: '—' }}</td>
      <td>
        <a class="btn btn-sm btn-secondary" href="{{ path('app_user_skills_edit', {id: us.id}) }}">✏️ Modifier</a>
        <form method="post" action="{{ path('app_user_skills_delete', {id: us.id}) }}" style="display:inline" onsubmit="return confirm('Supprimer ?');">
          <input type="hidden" name="_token" value="{{ csrf_token('delete_user_skill_' ~ us.id) }}">
          <button class="btn btn-sm btn-danger">🗑️ Supprimer</button>
        </form>
      </td>
    </tr>
  {% else %}
    <tr><td colspan="4">Aucune compétence pour le moment.</td></tr>
  {% endfor %}
  </tbody>
</table>

<p class="mt-3">
  <a class="btn btn-secondary" href="{{ path('app_home') }}">🏠 Retour à l’accueil</a>
</p>
{% endblock %}
